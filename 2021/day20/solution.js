let raw = `..#.#..#####.#.#.#.###.##.....###.##.#..###.####..#####..#....#..#..##..###..######.###...####..#..#####..##..#.#####...##.#.#..#.##..#.#......#.###.######.###.####...#.##.##..#..#..#####.....#.#....###..#.##......#.....#..#..#..##..#...##.######.####.####.#.#...#.......#..#.#.#...####.##.#......#..#...##.#.##..#...##.#.##..###.#......#.#.......#.#.#.####.###.##...#.....####.#..#..#.##.#....##..#.####....##...##..#...#......#.#.......#.......##..####..#...#.#.#...##..#.#..###..#####........#..####......#..#

#..#.
#....
##..#
..#..
..###`;

let raw2 = `########...#.###.##..#.....#####....#.#...#..##..##.###.....####...#.#..#.###...#.#.##...#..##.###..##......##....##....#.#..#...##.###..#.#.#####..##.##....#.#####.#.######...#.####....#.#.####..#.####.#.#..##......#....#.##...#...#...#......#...#...#.#.....###..#.##..#...####.##....#.#.#...##...####.#####.####.###.##.###.##...#.#.#...###.######....#.#.#.#..#.#....#####.#.##...##...##...##...#.#.#####.#...#.#######..#...##..#..#...#..####....###..#..##.##..#.#.##...#####......#.#.###.####...#.#.###.#.##.#.

###....###.#.#####.#..#..#.##...##.#.##.#..##..####..##....#.##.###..##....#####.#..#.######.#.#.##.
.##....######....#..#....###.#..##.#...##..#..#####..#.###...####.####...#.######.#.#.##.####.#.####
#.......#..#.#.##.##.##.#.##..###...###.#.#..#####...#..####.###..#.#..#.###.#..#..#.###.##..#...##.
....#......####.#...#.##.#..##....####.#.....####.#..##..#...#.##...#.#.##..##......#....#..#.##....
####..#.#....#...#.######.#.####.#.####.#####..###...##.#.###.##...##.........#.##.#..###..#.##...##
.##..#.#..#...#####.......#.##.#....###.#..###..##.##.#....###.##.#.#..##..#.#.....#.#.###...###.#..
..#.##.#...#.#..#.##.##..#.##.#...###..##..#.#..#..##..#.#.###.##.##...##.###....#.###...#.###..#...
####....#######.#.#..#..###......##..###.#.#.#.#.#..###.##...###.##.##..##.#..#.#.##..#..#..###..#.#
..##..###.##......###.####.#....##.##.#..#..#...#.####......###.#.##.#..#.##.......#..#...#..###.###
##.##.##..#.##..#..#..##.###..###..#.##.###.#...####.#.#......###........##.#.#######.#.#...###.##.#
.##.#...#..###.###..###.##.##.#..##.#.#.#...#....######.#...#.....##...##.#.#....###.###....#.#.##..
##...#..#.#.#.#.#.###.....#....##.##.#.##.##...#.#.#.#.#...#....####..##..#.####........#...#.##....
.#.#####.#...###.###..##.##.##..#...###.##.#.#..#..#.#.###..#.###..#.#..####..#......####.#.#....###
##.#####.#...#..#..##..###.##.##..#.......#.####.#.#..####..###.....###.....#..#..#..#.##....####...
.##.##.#.#..##..####...#..#..#..#.#.#.#.####.####.#####.....#.#.##..#...#.###.#.....#..####.#.##.###
###.#.....#..#..##........#.#..##....##.###..#.#..#..#.#####..##.#.###..##.#######...#..#.....##.###
.##.##..##..##..##..####.##.#..##..####.##.##.#.##..#.##.###..#.##.#...#.###..#.#.###.#####..#.#.#..
...#.#...#..#...#....####.....##...###...#..######.##..##.##..###...#..###..###.##..####.###.###.#..
##.#..##....#.#.##..##......#..##.....##.##..#.##...##.##.#####.#....#.#..#...#.#....#.###...###....
.#.#......##.#...#...###....###...##.#.###.#...#..#######..#######.#....###.#..#.#.#.##....#.#..#.##
###.####...#....#...#####.#.###.#.#.#......##.##..#.#####..#.####.##.##.##..###.##...##..#.##...##..
####.##...##....#..###.#...#.#.#...#..##..##.##.##..#.#.####..#..#.#.#.####......#.###.##.....#...##
.##.##..#.#....######.##......#...#.#.####..#.####.##.##.###.#.#..######.######.#.#...#.######..#...
#....##.#.##.#.###..#####.###.##.#...#..#.#..###.#....#.###..#..#.#..#.###...#.....#..##............
#.#.###..##.###...#..###.#.##.#####.##.#...#...#........#....###.#######..##.#.....#..#.#.###..####.
..####.##..#.##.#.....#....##....#..######.#..#...#......#.##..##.#.#..######..###..##.#.#.###...###
##....#..##.#..#.#....#...###..#.###......##.##.#.#.#..#...###....#.###.##....###.###.#..###..#.###.
##...###.####.#...#.####.##.#...#.##....#.....#.##..##..#####.#.#.......#.#..#...#.##.###.....######
#.###...##..##.##.####....##.#..###########.#..##..#...#.##.###...#...#..##.#.....#.#..##.##...#.#..
....#..##...#.#####.#.####.#..##..###.###..#.#.##..#.#.#.#..#.....##..######.####.#####.#....##..#.#
##..##.#.#.##..#..#....#.#.#..##.###.......#.###..#.#..####...##...#####......####..##.#.#.##.####.#
#####.#.##.#....#.##....#...###.##..##...#...#.###..###..##.###.#.#.#.#...#.#..#.#.##.#.##.######.##
#.##..#.##.#.###.##..#####..#.....#.###..##.#.#.####.###.#....###...#.#..#..##..#.##....#.##.##.###.
.#...##..##.#..#..##.##..#.#.........##.#######...#.#......##########..##.##..#.#.###.....#....#####
##.......#.##.#..#.####..##.#.####.##..#.#....#..#..#.###.#.#.#.##..####..##.##.#..#..#.##..#.##..#.
#######...........#...####.####........##.###.###.#.###.###.##.#.##.#..#.####...###..#..###...##...#
.##......#.####.####..#.#......###.#.##.#####..###.##....#.##..##.#.##.#.#..#####..#.#...#..#.##..##
..#.####..###.#.##.#..##.###..###.#..#...#########...#.....#.##....###....#..#..#.##.#...###..###.##
###.#.##.#.#...#..##.###.#.#...#.##.#..#..#..#.#.#.#..##.#.###.#....#......###..##.#.#.####.##...#.#
.##...........#..#..#.#....##..#.#.###.#.#.###.##.#..##...#...##..###.#......#.##.##...#..##.#......
##..###..##.#..##..##..####...#......###.#.###...#.###..#.#.#..#####....##.###.......###..#.#..##...
##...#.#####.###.#####...#####..#.#..##.#.###..#.###.#..##.#.#..#.##....#....#.#..##.##.###.##..###.
.#....#.##.#..#.#.#.#.##...###..#...#..##.########.....####.#####..#.#..#.#.##....#..#.#..##.##.....
..#...#..###.#.#.#.##.#####.#.#...#...#..###...#...#.#.....##...#.###.#...###.....#..#.####.#.###.##
.#...##..#...#..#.#.#..######..##.....#######.####......##.#.##.#..##..#.##....#...##.###..###.#....
.#..#..###.####..#.##.###......####...#####...#..#.#.####..#..####.#.####..#..##.##.#.#...###...##.#
######.#....#.#......#..#..#....#.###...##..#.#.##.##.#.##.##.##.#..#.##.#.##.##...#.####.#.##...###
..####.#####.###.###.##..##..#..#..########..##.####..#..#..##.####.##.####.###....##..#..###...#..#
##.#....####.#..#...##...#..#..#.#..#.#.####...###.#.###.###...#..#.####.####.#......####.#####..#..
...#...#....##..#...#....###.....#.#...#.##.#######.....#..#.#.#...#..#.###.##.###....#...#.##.....#
##.#.#.#########...##.#########.#....#.#..#.##...##......#.##..###.####.#.#.#...#.##.##..##.##.##.##
.............#.#.#..##.#..#.#.####..#..###.###.##.#.#.###.#..#.#..#...###..###.##......#.###.###..##
..##.#.....#..###..##.#...###...###..##.#####...#.#.#.#...##.#.....###.####...####.##......#.#.#...#
##.#...#.......###...##..#.#..#..###...###..##......#.#.#...##..###...#..#.#..##.#...#..###.##..#.##
#...#.###.#..#...###..#.###.#####..##.###..#.##.##....####.#.##########..#####.###.###...##.#..##.#.
.#.#.#...#.#.#..#...##....#.#...###.#.#####.#.##.#....##..#.#..#..##..#..#........###..#..#.......##
####.##...#....#####...##.###.#...###..##....#....#.#.###..##.##.#....#...###..#####.##.#..###.##.##
..##..#.#.#.##.#.....#.#.....#.##..#.#.#..#.##.#..####.#...#.###.#...#####.##...###..#.#.#.#####.#..
#.###.##....##..#.##.#...#..###...#...#.......###...#.#..##...###.#.#.###..#.#####.#.###.##.#.####..
.#.###..##...#...####.##.##.##...#..#.#...#...#...#..##.###......#.#...#.#.#.#....#.#..#.##.#.####.#
.##########.#..#.##..#.###..#####.#..##.#......#.####..##.#.####.####.####....###.###.###...#.#..#..
#..##.###..#########......#..#.#.#..#.#.##...#.##.#...#.#.#.#...#.....##.#..#.######.###....#.#...#.
.##..#..##.#..#..####.#....##....###...#.####....############.#.......#.#.##.#...###.##.#...####.#..
#...#######..###..##......#....##....#.###.##..#.#.#.###.#.#.#.#.....##.#.#...####..#.#...#.#.#####.
..##.#.#...###....###..##.#######.#...##.#.#####.......#.#..##.#.#...##..##.#.#####..####....##..##.
#######.#.#.##.#.###..###.##..#.#.#.#..#...#...##..#...###..##.##..#.###.......##..##...#...#.#.##.#
#..#..#.###.#..#....##....#..####....#####.....##.##########.##.#...#..#.#.#.#.#.#.#.#.###..###..#..
.....##...##....#.....#.###..#.##.#..##...#..#.#####.##....####..##..##.##......#.#.#....###.#.#.##.
#..##....###...#.#.#...#.##......#.#####..#....#.#..#..#####.#.##..##.########.....#.#...#.########.
#.####...#....##..#.###....###.#......#..#..####.#.####.#...###.#..####...#....###...#.#..##.##..#..
....#.###....#...##......##.###.#####..##...######.##...#.#...#...#.###..#######.#####...#.#.####..#
.##.#.#..#..#.#.####..###.##....#...#.####..##.#...#..#.##..#.#.#...##.#...#..##.#..#####...#..##...
##.#..######.##..#.#.#...#.#.##....#...#.###...#####..#.#.....#...#.##..#...####.#..###.#.##.#.#..##
#.#..#.#...#.....#.##.###.#..#.###.#.#..###..##.#......#..#..##.....###.#...#.....##.#..###..##..#..
#.####.#.##.##..######.#.###...###.###...#.##......#..####...###..#..#.#.##.#....#####..##..##.#....
..##..#.#..#.####.#####.##.######.###..##.#.###.#...###.#.##..#.###.#########..##.#.#.#..#...###.###
##..#####.##.....#...###..####.##.#...#..#....###......##...#..#.#...##.#..###...#.#.#..##.##.#.#.##
#...#....#...###.##..##.#.##.......###.##.###..#.##.#.#.#...#..####.####.##.....##......##.##..###.#
..#...#...###.#.##.##.##.#.##...####..#..##..#..####.#.#..####...###.#.#...#..#..#.#....#.#.##.###.#
.###.#.#.##.......##...#.####.#.######.#..##....#.#.....#..#.#..####...#.#..##.....#.#.#.......##..#
########.#.####...###.#...##.#..##.#.#.#####.#...#...#.####...#####..#.###.....##...#..###.##...#.##
...#.....#..####......###.##.##.###.#.#.#..###..##..##########.###.######.###....#.#..######.###...#
##....#.#......#..##.###.#..#.....###.##.###.####..#.#...#..#####.#..##.#....##...#..##....#.###.#.#
.#.#...#..##..##.###.#...#.#.........###.#.#....#..#...#.###.####...#.#...#.....#...#####.###..#..#.
#...#.###......######.#...#.##.#.#.##.....####..#..##.##..##.#.###........###..####.######.#....#...
..####......##.#..#..#...#.###.######...####..##...#..###.##.#.######.#.##..#.##.##.##...####.#.....
..#.#.##..#.###..##.##.#.#.#.#.##....#.#.###..#.###.....#.#..########..##......##.#..###...#.##.##..
..#.....##..##.#..#.#..#..#.##..#.###..#..##.#..#.#..#..##.#.##..########.###.#.##.....#...#...#.###
...#..######..####......#..#............#.#..#.##..###.#...##....#..#..#.#.###.###.#..##...#.#......
...#.........#..##.##..#........#..#.##.....#...#.###.#.###.#.##.#####..#.##.#...#.###.###.#...#....
#..#####.##..####..###.#....#..#...#.####...#..#..##.#.###..##...###.#.#...##.#..####.#.#.#..##.#..#
..#..#...#.##.#.#.##.###...##..##.##.###...###.#..###...##.#..##.####....###.###..#.#..#.###.#.....#
.#.#.#.#....###.#..#..########.##.###..#.#.##..##..##.######...##.##..#.#.####.#.#####.#..#.##.####.
.##.#.##.##.#..#####..#.##..#.#.###..#..#..##...#.#.###.#.#.#...#..####.###.#........###.##..#...##.
.#.#####.#..##..##..##.#.#.#####.#.#.....#.#.#..#...#.#.#.####..#.#..#########...####..###.#...#.#..
.##..#..#.#.##.#.##..##.#.#..######..#..##..##...####.#.##..#.##.#..####.#.###...####..##...#.##..##
#..#.###..####.#####.#.#..#.##.##.##.##......#.#.###...#.........###...#.#.#.###.####.#..######..#.#
#.##########.#.##.##....#..#.######.####.#.####.##.####.##...###...#######.#..#.##..###.##..######..
....#.....#..###.......##.#...####...#.#..##.#..###..###...#...###.#..###.#.#.##.#.#.##.#....#...#..
..##...#.#.#.####.#..#.####...#...###.#..###..#.###.####....#.#....#...##...#.#.#....##.#.#.##....##`;

let raw3 = `########...#.###.##..#.....#####....#.#...#..##..##.###.....####...#.#..#.###...#.#.##...#..##.###..##......##....##....#.#..#...##.###..#.#.#####..##.##....#.#####.#.######...#.####....#.#.####..#.####.#.#..##......#....#.##...#...#...#......#...#...#.#.....###..#.##..#...####.##....#.#.#...##...####.#####.####.###.##.###.##...#.#.#...###.######....#.#.#.#..#.#....#####.#.##...##...##...##...#.#.#####.#...#.#######..#...##..#..#...#..####....###..#..##.##..#.#.##...#####......#.#.###.####...#.#.###.#.##.#.

.....
.....
.....
.....
.....
`;
let resizeMatrix = (matrix, char) => {
  let newMatrix = [];
  newMatrix.push(new Array(matrix[0].length + 2).fill(char));
  for (let i = 0; i < matrix.length; ++i) {
    newMatrix.push([char, ...matrix[i], char]);
  }
  newMatrix.push(new Array(matrix[0].length + 2).fill(char));
  return newMatrix;
};

let solve = (raw) => {
  let [algorithmText, image] = raw.split("\n\n");
  let matrix = [];
  let algorithm = algorithmText.split("");
  image.split("\n").forEach((row) => matrix.push(row.split("")));
  let litPixelCount = 0;
  for (let k = 0; k < 50; ++k) {
    let newMatrix = [];
    let char = k % 2 === 0 ? "." : "#";
    matrix = resizeMatrix(matrix, char);
    litPixelCount = 0;
    for (let i = 0; i < matrix.length; i++) {
      let newRow = [];
      for (let j = 0; j < matrix[0].length; j++) {
        let area = [];
        for (let ii = -1; ii <= 1; ++ii) {
          for (let jj = -1; jj <= 1; ++jj) {
            area.push(matrix?.[i + ii]?.[j + jj] ?? (k % 2 === 0 ? "." : "#"));
          }
        }
        let index = parseInt(area.map((c) => (c === "." ? 0 : 1)).join(""), 2);
        newRow.push(algorithm[index]);
        if (algorithm[index] === "#") ++litPixelCount;
      }
      newMatrix.push(newRow);
    }
    matrix = newMatrix;
  }
  console.log("lit pixels: ", litPixelCount);
};
solve(raw2);
